{"version":3,"file":"proxy.js","sources":["../../src/embed/proxy.js"],"sourcesContent":["// IframeTube - all rights reserved.\r\n// copyright (c) 2026\r\n// you may copy this project and modify it for personal use only.\r\n// you may not distribute this project or any modified versions of it without explicit permission from the author.\r\n\r\n// view the full source code and how this works here: https://github.com/IframeTube/IframeTube\r\n// if you encounter any issues, please report them here: https://github.com/IframeTube/IframeTube/issues\r\n\r\n\r\nlet IframeTube_proxy_init_timeout = false;\r\nfunction IframeTube_proxy_init() {\r\n    'use strict';  // better for debugging\r\n\r\n    // if document body does not exist yet, retry in 100ms until it does\r\n    if (!document.body) {\r\n        clearTimeout(IframeTube_proxy_init_timeout);\r\n        IframeTube_proxy_init_timeout = setTimeout(IframeTube_proxy_init, 100);\r\n        return;\r\n    }\r\n\r\n    // hide all other elements\r\n    let elements = document.querySelectorAll('body > *');\r\n    elements.forEach(el => {\r\n        el.style.display = 'none';\r\n    });\r\n\r\n    // make sure the page fills our entire view port, 'example.net' is weirdly configured, this fixes it\r\n    document.documentElement.style.width = '100%';\r\n    document.documentElement.style.height = '100%';\r\n    document.documentElement.style.margin = '0';\r\n    document.documentElement.style.padding = '0';\r\n\r\n    document.body.style.width = '100%';\r\n    document.body.style.height = '100%';\r\n    document.body.style.padding = '0';\r\n    document.body.style.margin = '0';\r\n\r\n    // black background\r\n    document.body.style.background = '#000000';\r\n\r\n    document.body.style.overflow = 'hidden';\r\n\r\n    // creates the Youtube embedded iframe\r\n    let embedIframe = document.createElement('iframe');\r\n    embedIframe.setAttribute('allow', 'autoplay *; picture-in-picture *; web-share *; gyroscope *; accelerometer *; clipboard-write *; encrypted-media *;'); // allows everything needed for a Youtube video\r\n    embedIframe.setAttribute('referrerpolicy', 'strict-origin-when-cross-origin'); // set a strict referrer policy\r\n    embedIframe.setAttribute('width', '100%');\r\n    embedIframe.setAttribute('height', '100%');\r\n    embedIframe.setAttribute('frameborder', '0'); // no border\r\n    embedIframe.setAttribute('scrolling', 'yes');\r\n    embedIframe.setAttribute('allowfullscreen', 'true');\r\n    embedIframe.setAttribute('id', 'IframeTube_embedVideo'); // set an ID, so we can access it\r\n    document.body.appendChild(embedIframe);\r\n\r\n    // add an event listener for messages from the top window\r\n    window.addEventListener('message', function (event) {\r\n        // if the message is not valid, do not proceed\r\n        if (typeof event.data !== 'string') {\r\n            return;\r\n        }\r\n\r\n        // refetch the embedded iframe (solves some edge cases)\r\n        let embedIframe = document.getElementById('IframeTube_embedVideo');\r\n        // if it exists\r\n        if (embedIframe) {\r\n            // if the data starts with the embedded URL (from the IframeTube_embedVideo() function)\r\n            if (event.data.startsWith('IframeTube_embedVideo_')) {\r\n                // replace the embedded iframe source with the Youtube url\r\n                embedIframe.contentWindow.location.replace(event.data.replace('IframeTube_embedVideo_', ''));\r\n            }\r\n            // otherwise, pass all other messages to the embedded iframe (e.g. stop playback or copy native autoplay attributes)\r\n            else {\r\n                embedIframe.contentWindow.postMessage(event.data, '*');\r\n            }\r\n        }\r\n    });\r\n\r\n    // tell the top window (youtube.com) that the proxy iframe has loaded\r\n    window.top.postMessage('IframeTube_proxyLoaded', '*');\r\n\r\n    // end of IIFE\r\n}\r\n\r\n// calls the proxy init function\r\nIframeTube_proxy_init();"],"names":["IframeTube_proxy_init_timeout","IframeTube_proxy_init","el","embedIframe","event"],"mappings":"AASA,IAAIA,EAAgC,GACpC,SAASC,GAAwB,CAI7B,GAAI,CAAC,SAAS,KAAM,CAChB,aAAaD,CAA6B,EAC1CA,EAAgC,WAAWC,EAAuB,GAAG,EACrE,MACJ,CAGe,SAAS,iBAAiB,UAAU,EAC1C,QAAQC,GAAM,CACnBA,EAAG,MAAM,QAAU,MACvB,CAAC,EAGD,SAAS,gBAAgB,MAAM,MAAQ,OACvC,SAAS,gBAAgB,MAAM,OAAS,OACxC,SAAS,gBAAgB,MAAM,OAAS,IACxC,SAAS,gBAAgB,MAAM,QAAU,IAEzC,SAAS,KAAK,MAAM,MAAQ,OAC5B,SAAS,KAAK,MAAM,OAAS,OAC7B,SAAS,KAAK,MAAM,QAAU,IAC9B,SAAS,KAAK,MAAM,OAAS,IAG7B,SAAS,KAAK,MAAM,WAAa,UAEjC,SAAS,KAAK,MAAM,SAAW,SAG/B,IAAIC,EAAc,SAAS,cAAc,QAAQ,EACjDA,EAAY,aAAa,QAAS,oHAAoH,EACtJA,EAAY,aAAa,iBAAkB,iCAAiC,EAC5EA,EAAY,aAAa,QAAS,MAAM,EACxCA,EAAY,aAAa,SAAU,MAAM,EACzCA,EAAY,aAAa,cAAe,GAAG,EAC3CA,EAAY,aAAa,YAAa,KAAK,EAC3CA,EAAY,aAAa,kBAAmB,MAAM,EAClDA,EAAY,aAAa,KAAM,uBAAuB,EACtD,SAAS,KAAK,YAAYA,CAAW,EAGrC,OAAO,iBAAiB,UAAW,SAAUC,EAAO,CAEhD,GAAI,OAAOA,EAAM,MAAS,SACtB,OAIJ,IAAID,EAAc,SAAS,eAAe,uBAAuB,EAE7DA,IAEIC,EAAM,KAAK,WAAW,wBAAwB,EAE9CD,EAAY,cAAc,SAAS,QAAQC,EAAM,KAAK,QAAQ,yBAA0B,EAAE,CAAC,EAI3FD,EAAY,cAAc,YAAYC,EAAM,KAAM,GAAG,EAGjE,CAAC,EAGD,OAAO,IAAI,YAAY,yBAA0B,GAAG,CAGxD,CAGAH,EAAqB"}